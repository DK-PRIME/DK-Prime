<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <title>DK Prime · Панель організатора</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body{
      margin:0;
      font-family:system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background:#020617;
      color:#e5e7eb;
    }
    header{
      background:#0f172a;
      border-bottom:1px solid rgba(148,163,184,.4);
      padding:10px 18px;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .logo{
      font-weight:700;
      letter-spacing:.08em;
      text-transform:uppercase;
      font-size:.85rem;
    }
    .role-label{
      font-size:.8rem;
      color:#9ca3af;
    }
    button.logout{
      border-radius:999px;
      border:1px solid rgba(148,163,184,.6);
      background:transparent;
      color:#e5e7eb;
      padding:6px 12px;
      font-size:.8rem;
      cursor:pointer;
    }
    main{
      padding:18px;
      max-width:900px;
      margin:0 auto 40px;
    }
    .card{
      background:#0f172a;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.4);
      padding:16px 14px 20px;
      margin-bottom:18px;
      box-shadow:0 16px 40px rgba(0,0,0,.9);
    }
    h2{
      margin:0 0 10px;
      font-size:1.1rem;
    }
    h3{
      margin:0 0 6px;
      font-size:.95rem;
    }
    .badge{
      font-size:.7rem;
      text-transform:uppercase;
      letter-spacing:.16em;
      color:#9ca3af;
      margin-bottom:4px;
      display:inline-block;
    }
    .hidden{display:none;}
    #systemMessage{
      margin-bottom:12px;
      font-size:.85rem;
      min-height:1.2em;
    }
    .muted{
      font-size:.8rem;
      color:#9ca3af;
    }

    .block{
      padding:10px 12px;
      border-radius:12px;
      border:1px dashed rgba(148,163,184,.4);
      background:rgba(15,23,42,.6);
      margin-top:10px;
    }
    label.field-label{
      display:block;
      font-size:.8rem;
      color:#9ca3af;
      margin-bottom:3px;
    }
    input, select, button{
      font-family:inherit;
      font-size:.85rem;
    }
    input[type="text"],
    input[type="number"],
    select{
      width:100%;
      padding:6px 8px;
      border-radius:8px;
      border:1px solid rgba(148,163,184,.4);
      background:#020617;
      color:#e5e7eb;
    }
    input:disabled, select:disabled{
      opacity:.6;
      cursor:not-allowed;
    }
    .row{
      display:flex;
      flex-wrap:wrap;
      gap:8px;
      align-items:center;
      margin-top:8px;
    }
    .chip{
      font-size:.75rem;
      padding:4px 8px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,.4);
    }
    .chip-muted{
      background:rgba(15,23,42,.8);
      color:#9ca3af;
    }
    .chip-open{
      background:rgba(22,163,74,.16);
      border-color:rgba(34,197,94,.7);
      color:#bbf7d0;
    }
    .chip-closed{
      background:rgba(127,29,29,.25);
      border-color:rgba(248,113,113,.7);
      color:#fecaca;
    }
    .btn{
      border-radius:999px;
      border:1px solid rgba(250,204,21,.8);
      background:linear-gradient(to right,rgba(250,204,21,.08),rgba(248,113,113,.08));
      color:#fde68a;
      padding:6px 12px;
      cursor:pointer;
      font-size:.8rem;
      white-space:nowrap;
    }
    .btn:disabled{
      opacity:.5;
      cursor:not-allowed;
    }
    .btn-secondary{
      border-color:rgba(148,163,184,.8);
      background:transparent;
      color:#e5e7eb;
    }

    /* Великі вертикальні кнопки інших дій */
    .big-actions{
      margin-top:20px;
    }
    .big-btn{
      width:100%;
      padding:16px 14px;
      margin-bottom:10px;
      border-radius:16px;
      border:1px solid rgba(148,163,184,.7);
      background:#020617;
      color:#e5e7eb;
      text-align:left;
      cursor:pointer;
      display:flex;
      justify-content:space-between;
      align-items:center;
    }
    .big-btn span.title{
      font-size:.95rem;
      font-weight:600;
    }
    .big-btn span.subtitle{
      font-size:.8rem;
      color:#9ca3af;
      display:block;
      margin-top:2px;
    }
    .big-btn span.arrow{
      font-size:1.3rem;
      opacity:.8;
    }
  </style>
</head>
<body>
  <header>
    <div>
      <div class="logo">DK PRIME · CONTROL PANEL</div>
      <div id="userInfo" class="role-label">Перевірка доступу...</div>
    </div>
    <button class="logout" id="logoutBtn">Вийти</button>
  </header>

  <main>
    <div id="systemMessage"></div>

    <!-- ADMIN -->
    <section id="adminSection" class="card hidden">
      <span class="badge">admin</span>
      <h2>Панель організатора</h2>
      <p class="muted">
        Тут ти створюєш сезони/змагання, етапи, та керуєш відкриттям реєстрації.
      </p>

      <!-- Створити новий сезон / змагання -->
      <div class="block">
        <h3>Створити новий сезон / змагання</h3>
        <form id="createSeasonForm">
          <label class="field-label" for="seasonIdInput">ID сезону (наприклад: 2026)</label>
          <input type="text" id="seasonIdInput" placeholder="2026" required>

          <label class="field-label" for="seasonTitleInput">Назва сезону / турніру</label>
          <input type="text" id="seasonTitleInput" placeholder="STOLAR CARP 2026" required>

          <label class="field-label" for="seasonYearInput">Рік</label>
          <input type="number" id="seasonYearInput" placeholder="2026" required>

          <label class="field-label" for="seasonStagesInput">Кількість етапів (без фіналу)</label>
          <input type="number" id="seasonStagesInput" value="5" min="1" max="10" required>

          <div style="margin-top:8px;">
            <button type="submit" class="btn">Створити сезон + етапи 1–5 та Фінал</button>
          </div>
        </form>
        <p class="muted" style="margin-top:6px;">
          Буде створено документ у <code>seasons</code>, етапи в <code>stages</code> (1–5 та Фінал),
          а також оновлено <code>settings/active</code> на перший етап.
        </p>
      </div>

      <!-- Вибір активного сезону/етапу -->
      <div class="block">
        <h3>Активний сезон / етап</h3>

        <label for="seasonSelect" class="field-label">Обрати сезон / турнір</label>
        <select id="seasonSelect" disabled>
          <option value="">Завантаження...</option>
        </select>
        <div id="seasonInfo" class="muted" style="margin-top:4px;"></div>

        <div style="height:8px;"></div>

        <label for="stageSelect" class="field-label">Обрати етап</label>
        <select id="stageSelect" disabled>
          <option value="">Спочатку обери сезон</option>
        </select>

        <div class="row">
          <span id="stageStatusBadge" class="chip chip-muted">Статус: не обрано</span>
          <button id="toggleStageBtn" class="btn" disabled>Відкрити реєстрацію</button>
        </div>

        <p class="muted" style="margin-top:4px;">
          Активний етап зберігається в <code>settings/active</code> і дублюється в <code>localStorage</code>.
          Колір: <span style="color:#bbf7d0;">зелений</span> – відкрито, <span style="color:#fecaca;">червоний</span> – закрито.
        </p>
      </div>
    </section>

    <!-- JUDGE (заглушка) -->
    <section id="judgeSection" class="card hidden">
      <span class="badge">judge</span>
      <h2>Панель судді</h2>
      <p class="muted">
        Для суддів використовується окрема сторінка <code>judges.html</code>, де кожен бачить тільки свою зону (A/B/C).
      </p>
    </section>

    <!-- NO ACCESS -->
    <section id="noAccessSection" class="card hidden">
      <span class="badge">доступ заборонено</span>
      <h2>Недостатньо прав</h2>
      <p>Ваш акаунт не має ролі admin або judge. Зверніться до організатора.</p>
    </section>

    <!-- Великі кнопки інших дій (поза рамками карток) -->
    <section id="bigActionsSection" class="big-actions hidden">
      <button class="big-btn" onclick="window.location.href='registrations.html'">
        <div>
          <span class="title">Реєстрація учасників</span>
          <span class="subtitle">Перегляд заявок на активний етап, підтвердження оплати</span>
        </div>
        <span class="arrow">➜</span>
      </button>

      <button class="big-btn" onclick="window.location.href='draw.html'">
        <div>
          <span class="title">Жеребкування</span>
          <span class="subtitle">Розподіл підтверджених команд по зонах та секторах</span>
        </div>
        <span class="arrow">➜</span>
      </button>

      <button class="big-btn" onclick="window.location.href='judges.html'">
        <div>
          <span class="title">Зони суддів A / B / C</span>
          <span class="subtitle">Внесення зважувань по своїй зоні, адмін бачить усі</span>
        </div>
        <span class="arrow">➜</span>
      </button>
    </section>
  </main>

  <script type="module" src="./firebase-config.js"></script>
  <script type="module" src="./admin_judge_logic.js"></script>
</body>
</html>
